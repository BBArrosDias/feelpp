stokes=1
newton=0
picard=1
blockns=1

mu=0.0035
rho=1056

bc-file=$top_srcdir/benchmarks/navierstokes/steps/fda_3d.bc

bdf.time-step=1e-2
bdf.time-initial=0
bdf.time-final=1
bdf.order=2

[functions]
g={0,0,0.09225*(1-(x*x+y*y)/(0.006*0.006))}:x
h={0,0,0}


[blockns]
cd=true
pcd=true

[blockns.pmm]
# consider diagonal pressure mass matrix
diag=0

[blockns.pcd]
# CL at inflow of pressure
inflow=Robin
# CL at outflow of pressure
outflow=Dirichlet#Neumann
# Mp Fp^-1 Ap : 1, other Ap Fp^-1 Mp
order=1

# Ap : diffusion operator
[Ap]
pc-type=lu
#sub-pc-type=lu
ksp-monitor=1
# pressure convection-diffusion operator
[Fp]
pc-type=gasm
sub-pc-type=lu
# velocity convection diffusion operator
[Fu]
pc-type=gasm
sub-pc-type=lu
ksp-monitor=0
# pressure mass matrix
[Mp]
pc-type=gasm
sub-pc-type=lu
ksp-monitor=0


[newton]
preconditioner=PCD
tol=1e-5
maxit=50
ksp-type=gcr
ksp-rtol=1e-6
ksp-monitor=1
ksp-maxit=100
ksp-use-initial-guess-nonzero=false
gcr-restart=100

[picard]
preconditioner=PCD
tol=1e-5
maxit=50
ksp-rtol=1e-7
ksp-monitor=1
ksp-maxit=100#30
ksp-type=gcr
ksp-use-initial-guess-nonzero=false
gcr-restart=100

[stokes]
preconditioner=PCD #petsc#PMM
ksp-rtol=1e-7#1e-10
ksp-monitor=1
ksp-type=gcr
ksp-use-initial-guess-nonzero=false
gcr-restart=100

[gmsh]
#hsize=0.1
filename=$top_srcdir/benchmarks/navierstokes/steps/fda-3d.geo
#geo-variables-list=L=5:dim=3