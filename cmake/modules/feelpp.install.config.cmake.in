
set(_FEELPP_CONFIG_LIB_FILE @FEELPP_CONFIG_LIB_FILE@)
set(FEELPP_BINARY_BUILD_DIR @FEELPP_BINARY_DIR@)
set(FEELPP_SOURCE_BUILD_DIR @FEELPP_SOURCE_DIR@)

if ( EXISTS ${_FEELPP_CONFIG_LIB_FILE} )

  set(FEELPP_DONT_SETUP_CMAKE 1)
  include( ${_FEELPP_CONFIG_LIB_FILE})
  unset(FEELPP_DONT_SETUP_CMAKE)

  string(REPLACE ${FEELPP_BINARY_BUILD_DIR}/feel/ ${FEELPP_INSTALL_DIR}/lib/  FEELPP_LIBRARY  "${FEELPP_LIBRARY}" )
  
  set(DIRS_TO_MODIFY)
  if ( FEELPP_HAS_GFLAGS )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/gflags/ )
  endif()
  if ( FEELPP_HAS_GLOG )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/glog/ )
  endif()
  if ( FEELPP_HAS_GINAC )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/ginac/ginac/ )
  endif()
  if ( FEELPP_HAS_METIS )
     list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/metis/libmetis/ )
  endif()
  if ( FEELPP_HAS_NLOPT )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/nlopt/ )
  endif()
  if ( FEELPP_HAS_IPOPT )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/contrib/ipopt/ )
  endif()

  foreach( DIR_TO_MODIFY ${DIRS_TO_MODIFY} )
    string(REPLACE ${DIR_TO_MODIFY} ${FEELPP_INSTALL_DIR}/lib/  FEELPP_LIBRARIES  "${FEELPP_LIBRARIES}" )
  endforeach()

  set(FEELPP_LIBRARIES_WITH_SPACE)
  foreach( THELIB ${FEELPP_LIBRARIES} )
    list(APPEND FEELPP_LIBRARIES_WITH_SPACE " ${THELIB} ")
  endforeach()
  set(FEELPP_LIBRARIES_TEXT "set(FEELPP_LIBRARY ${FEELPP_LIBRARY} )\nset(FEELPP_LIBRARIES ${FEELPP_LIBRARIES_WITH_SPACE})" )
  file( WRITE ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.libraries.config.cmake ${FEELPP_LIBRARIES_TEXT} )
  file( INSTALL ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.libraries.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/ )

  set(FEELPP_INCLUDE_DIR_WITH_SPACE)
  foreach( THEINC ${FEELPP_INCLUDE_DIR} )
    string( FIND ${THEINC} ${FEELPP_BINARY_BUILD_DIR} FINDINCBIN )
    string( FIND ${THEINC} ${FEELPP_SOURCE_BUILD_DIR} FINDINCSOURCE )
    if( ( "${FINDINCBIN}" STREQUAL "-1") AND ( ( "${FINDINCSOURCE}" STREQUAL "-1") ))
      list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE " ${THEINC} ")
    endif()
  endforeach()
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE " ${FEELPP_INSTALL_DIR}/include/feelpp ")
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/eigen/ ")
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/eigen/unsupported/ ")
  if ( FEELPP_HAS_GINAC )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/ginac/ ")
  endif()
  if ( FEELPP_HAS_METIS )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/metis/ ")
  endif()
  if ( FEELPP_HAS_NLOPT )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/nlopt/ ")
  endif()
 if ( FEELPP_HAS_IPOPT )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/ipopt/ ")
  endif()

  set(FEELPP_INCLUDE_DIR_TEXT "set(FEELPP_INCLUDE_DIR ${FEELPP_INCLUDE_DIR_WITH_SPACE})")
  #string(REPLACE ";" "" FEELPP_INCLUDE_DIR_TEXT ${FEELPP_INCLUDE_DIR_TEXT} )
  file( WRITE ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.include.config.cmake ${FEELPP_INCLUDE_DIR_TEXT} )
  file( INSTALL ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.include.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/ )

  file(INSTALL ${FEELPP_BINARY_BUILD_DIR}/cmake/modules/feelpp.compile.definition.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/
    )
endif()
