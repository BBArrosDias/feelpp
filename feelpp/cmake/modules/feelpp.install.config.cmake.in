
set(_FEELPP_CONFIG_LIB_FILE @FEELPP_CONFIG_LIB_FILE@)
set(FEELPP_BINARY_BUILD_DIR @FEELPP_BINARY_DIR@)
set(FEELPP_SOURCE_BUILD_DIR @FEELPP_SOURCE_DIR@)
set(FEELPP_PREFIX @FEELPP_PREFIX@)

if ( EXISTS ${_FEELPP_CONFIG_LIB_FILE} )

  set(FEELPP_DONT_SETUP_CMAKE 1)
  include( ${_FEELPP_CONFIG_LIB_FILE})
  unset(FEELPP_DONT_SETUP_CMAKE)

  list(REMOVE_ITEM FEELPP_LIBRARIES ${FEELPP_LIBRARY})
  string(REPLACE ${FEELPP_BINARY_BUILD_DIR}/feel/ ${FEELPP_INSTALL_DIR}/lib/  FEELPP_LIBRARY  "${FEELPP_LIBRARY}" )
  
  set(DIRS_TO_MODIFY)
  if ( FEELPP_HAS_GFLAGS )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/gflags/ )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_gflags)
  endif()
  if ( FEELPP_HAS_GLOG )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_glog)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/glog/ )
  endif()
  if ( FEELPP_HAS_GINAC )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_ginac)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/ginac/ginac/ )
  endif()
  if ( FEELPP_HAS_METIS )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_metis)
     list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/metis/libmetis/ )
  endif()
  if ( FEELPP_HAS_NLOPT )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_nlopt)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/nlopt/ )
  endif()
  if ( FEELPP_HAS_IPOPT )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_ipopt)
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_ipoptfort)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/ipopt/ )
  endif()
  if ( FEELPP_HAS_PYBIND11 )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/pybind11/ )
  endif()
  if ( FEELPP_HAS_MONGOCXX )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_mongocxx)
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_bsoncxx)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/mongocxx/src/bsoncxx )
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/mongocxx/src/mongocxx )
  endif()
  if ( FEELPP_HAS_KWSYS )
    list(REMOVE_ITEM FEELPP_LIBRARIES feelpp_kwsys)
    list(APPEND DIRS_TO_MODIFY ${FEELPP_BINARY_BUILD_DIR}/feelpp/contrib/kwsys/ )
  endif()

  foreach( DIR_TO_MODIFY ${DIRS_TO_MODIFY} )
    string(REPLACE ${DIR_TO_MODIFY} ${FEELPP_INSTALL_DIR}/lib/  FEELPP_LIBRARIES  "${FEELPP_LIBRARIES}" )
  endforeach()

  set(FEELPP_LIBRARIES_WITH_SPACE)
  foreach( THELIB ${FEELPP_LIBRARIES} )
    list(APPEND FEELPP_LIBRARIES_WITH_SPACE " ${THELIB} ")
  endforeach()
  set(FEELPP_LIBRARIES_TEXT "
  set(FEELPP_LIBRARY ${FEELPP_LIBRARY} )
  set(FEELPP_LIBRARIES \${FEELPP_LIBRARY} ${FEELPP_LIBRARIES_WITH_SPACE})" )
  file( WRITE ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.libraries.config.cmake ${FEELPP_LIBRARIES_TEXT} )
  file( INSTALL ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.libraries.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/ )

  set(FEELPP_INCLUDE_DIR_WITH_SPACE)
  foreach( THEINC ${FEELPP_INCLUDE_DIR} )
    string( FIND ${THEINC} ${FEELPP_BINARY_BUILD_DIR} FINDINCBIN )
    string( FIND ${THEINC} ${FEELPP_SOURCE_BUILD_DIR} FINDINCSOURCE )
    if( ( "${FINDINCBIN}" STREQUAL "-1") AND ( ( "${FINDINCSOURCE}" STREQUAL "-1") ))
      list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE " ${THEINC} ")
    endif()
  endforeach()
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE " ${FEELPP_INSTALL_DIR}/include/feelpp ")
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/eigen/ ")
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/eigen/unsupported/ ")
  list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE " ${FEELPP_INSTALL_DIR}/include/feelpp/gmsh ")
  if ( FEELPP_HAS_GINAC )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/ginac/ ")
  endif()
  if ( FEELPP_HAS_METIS )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/metis/ ")
  endif()
  if ( FEELPP_HAS_NLOPT )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/nlopt/ ")
  endif()
 if ( FEELPP_HAS_IPOPT )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/ipopt/ ")
  endif()
  if ( FEELPP_HAS_PYBIND11 )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/pybind11/ ")
  endif()
  if ( FEELPP_HAS_MONGOCXX )
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/bsoncxx/ ")
    list(APPEND FEELPP_INCLUDE_DIR_WITH_SPACE  " ${FEELPP_INSTALL_DIR}/include/feelpp/mongocxx/ ")
  endif()

  set(FEELPP_INCLUDE_DIR_TEXT "set(FEELPP_INCLUDE_DIR ${FEELPP_INCLUDE_DIR_WITH_SPACE})")
  #string(REPLACE ";" "" FEELPP_INCLUDE_DIR_TEXT ${FEELPP_INCLUDE_DIR_TEXT} )
  file( WRITE ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.include.config.cmake ${FEELPP_INCLUDE_DIR_TEXT} )
  file( INSTALL ${FEELPP_BINARY_BUILD_DIR}${CMAKE_FILES_DIRECTORY}/feelpp.include.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/ )

  file(INSTALL ${FEELPP_BINARY_BUILD_DIR}/feelpp/cmake/modules/feelpp.compile.definition.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/
    )

  file(INSTALL ${FEELPP_BINARY_BUILD_DIR}/feelpp/cmake/modules/feelpp.boost.config.cmake
    DESTINATION ${FEELPP_INSTALL_DIR}/share/feelpp/feel/cmake/modules/
    )

  
endif()
